------

# 总体

> 作者：hou

## 1.1 云端

### 1.1.1 实现原理
1. 流程
    1. 客户端请求穿透，服务端验证管理员身份，向云端请求peerID、peerPwd和accessVerify
    2. 服务端根据peer账号密码向穿透端开启穿透
    3. 客户端通过服务端得到accessID，向云端请求得到peerID、accessVerify
    4. 客户端根据peer账号向穿透端开启穿透
    5. 客户端与服务端进行握手连接，校验accessVerify
2. 安全性
    1. 服务端和云端加密通信
    2. 数据安全由nas端网关和账号体系负责
3. 加密 
    1. 客户端生成aes的key和nonce
    2. 客户端用aes加密data
    3. 客户端用rsa加密aes的key
    4. 服务端拿rsa私钥解密key
    5. 然后还原data
4. 客户端和服务端之间的握手连接是如何实现的？在握手过程中，哪些信息需要校验？
5. 提到的“穿透”指的是什么？讲讲NAT、STUN、TURN
    1. A 在局域网，B 在另一个局域网，他们都访问一个 **公网服务器 C**，通过 `C` 来协调连接，最终使 A 和 B 建立直连（若失败再用 C 中转）。
    2. NAT：允许多个设备共享一个公共IP地址以访问互联网
    3. STUN：允许NAT后的设备发现其公共IP地址和端口。当两个设备都知道对方的公共IP和端口时，它们就可以尝试建立P2P连接。
    4. TURN：数据中转站
6. 网络错误或者请求错误如何处理
7. 切换是什么？如何操作